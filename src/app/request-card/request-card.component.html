<div
  class="relative bg-white rounded-2xl border border-slate-200 p-5 shadow-sm transition-all duration-200 group overflow-hidden"
  [ngClass]="{
    'hover:shadow-md hover:border-slate-300 cursor-pointer': clickable,
    'opacity-75': request.status === RequestStatus.Done
  }"
>
  @if (request.isDetailed) {
  <div class="absolute top-0 right-0 z-10">
    <div
      [ngClass]="isBug ? 'bg-red-500' : 'bg-primary-500'"
      class="text-white text-[10px] px-2 py-1 rounded-bl-lg font-bold shadow-sm"
    >
      <i class="pi pi-file text-xs"></i>
    </div>
  </div>
  } @if (showCategory) {
  <div class="absolute top-0 left-0 z-10">
    <span
      class="bg-slate-100 text-slate-500 text-[10px] font-bold px-3 py-1 rounded-br-lg border-b border-r border-slate-100"
    >
      {{ request.categoryName }}
    </span>
  </div>
  }

  <div class="flex gap-4 mt-2">
    <div
      [class]="
        'flex flex-col items-center justify-center self-start rounded-xl px-2 py-2 min-w-[3.5rem] border transition-colors ' +
        getVoteBoxBackgroundClass
      "
      [ngClass]="
        isBug
          ? 'group-hover:border-red-200 group-hover:bg-red-50'
          : 'group-hover:border-primary-200 group-hover:bg-primary-50'
      "
      (click)="onVoteClick()"
    >
      <i
        [class]="'pi pi-chevron-up mb-1 ' + getIconColorClass"
        [ngClass]="
          isBug ? 'group-hover:text-red-600' : 'group-hover:text-primary-600'
        "
      ></i>

      <span
        [class]="'font-bold text-lg leading-none ' + getCountColorClass"
        [ngClass]="
          isBug ? 'group-hover:text-red-700' : 'group-hover:text-primary-700'
        "
      >
        {{ request.votesCount }}
      </span>
    </div>

    <div class="flex flex-col flex-grow gap-2 min-w-0">
      <h3
        class="font-bold text-slate-800 text-lg leading-snug break-words"
        [ngClass]="{
          'line-through text-slate-400': request.status === RequestStatus.Done
        }"
      >
        {{ request.title }}
      </h3>

      @if (showDescription && request.description) {
      <p class="text-slate-500 text-sm line-clamp-2 leading-relaxed">
        {{ request.description }}
      </p>
      }

      <div
        class="flex items-center justify-between mt-3 pt-3 border-t border-slate-50"
      >
        <div class="flex items-center gap-3 text-xs text-slate-400">
          <span
            class="flex items-center gap-1 font-medium"
            [class]="typeColorClass"
          >
            <i [class]="typeIcon"></i>
            {{ isBug ? "خطأ" : "اقتراح" }}
          </span>

          <span class="flex items-center gap-1">
            <i class="pi pi-clock"></i>
            {{ request.createdAt | date : "shortDate" }}
          </span>
        </div>

        @if (showStatus) {
        <div
          class="w-3 h-3 rounded-full shadow-sm ring-2 ring-white cursor-help"
          [ngClass]="getStatusColor(request.status)"
          [pTooltip]="getStatusLabel(request.status)"
          tooltipPosition="top"
        ></div>
        }
      </div>
    </div>
  </div>
</div>
