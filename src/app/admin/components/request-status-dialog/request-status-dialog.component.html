<p-dialog
  header="تحديث حالة الطلب"
  [(visible)]="visible"
  [modal]="true"
  [style]="{ width: '500px', maxWidth: '95vw' }"
  [draggable]="false"
  [resizable]="false"
  dir="rtl"
  (onHide)="close()"
>
  <div class="flex flex-col gap-4 pt-3">
    <div
      class="bg-blue-50 p-3 border-round border-blue-100 flex items-center gap-3 shadow-1"
    >
      <i class="pi pi-info-circle text-blue-600 text-2xl"></i>
      <div class="flex gap-4 items-center">
        <span class="text-blue-900 font-medium text-sm"
          >أنت تقوم بتغيير الحالة إلى:</span
        >
        <p-tag
          [value]="getEnumLabel(newStatus! + (nextStatus ? 1 : 0))"
          [severity]="getSeverity(newStatus! + (nextStatus ? 1 : 0))"
          class="text-base"
        ></p-tag>
      </div>
    </div>

    <div class="flex flex-col gap-2">
      <label for="updateMsg" class="font-bold text-900 text-lg">
        رسالة التحديث (السجل)
      </label>
      <textarea
        id="updateMsg"
        rows="5"
        pInputTextarea
        [(ngModel)]="updateMessage"
        class="w-full text-lg p-3 line-height-3"
        placeholder="اشرح سبب تغيير الحالة..."
        style="min-height: 120px"
      ></textarea>
      <small class="text-500">
        هذه الرسالة ستظهر في سجل النشاطات للمستخدمين.
      </small>
    </div>

    <div class="flex flex-col gap-3 p-3 border-round">
      <div class="field-checkbox mb-0 flex items-center">
        <p-checkbox
          [(ngModel)]="notifyUsers"
          [binary]="true"
          inputId="notify"
        ></p-checkbox>
        <label for="notify" class="mr-3 cursor-pointer select-none text-900">
          <span>إشعار المصوتين عبر البريد الإلكتروني</span>
        </label>
      </div>

      <div class="field-checkbox mb-0 flex items-center">
        <p-checkbox
          [(ngModel)]="isInternal"
          [binary]="true"
          inputId="internal"
        ></p-checkbox>
        <label
          for="internal"
          class="mr-3 cursor-pointer select-none text-darkGrayBlue font-medium"
        >
          <span>تحديد كملاحظة داخلية (خاص)</span>
        </label>
      </div>
    </div>
  </div>

  <ng-template pTemplate="footer">
    <div
      class="flex gap-2 justify-content-start border-top-1 surface-border pt-3 mt-2"
    >
      <button
        pButton
        label="تأكيد التحديث"
        icon="pi pi-check"
        class="p-button-success px-4"
        (click)="confirm()"
      ></button>
      <button
        pButton
        label="إلغاء"
        icon="pi pi-times"
        class="p-button-text p-button-secondary"
        (click)="close()"
      ></button>
    </div>
  </ng-template>
</p-dialog>
