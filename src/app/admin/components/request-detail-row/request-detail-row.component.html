<div class="p-4 border-bottom-1 surface-border bg-gray-50" dir="rtl">
  <div class="mb-5">
    <h4 class="mt-0 mb-2 text-900 font-bold">الوصف</h4>
    <p class="line-height-3 text-700 m-0" style="max-width: 900px">
      {{ truncatedDescription }}
    </p>
  </div>

  <div class="flex gap-2 mb-5">
    <button
      pButton
      label="إضافة تحديث عام"
      icon="pi pi-megaphone"
      class="p-button-outlined p-button-primary p-button-sm"
      (click)="addPublicUpdate()"
    ></button>

    <button
      pButton
      label="إضافة ملاحظة داخلية"
      icon="pi pi-lock"
      class="p-button-outlined p-button-warning p-button-sm"
      (click)="addInternalNote()"
    ></button>
  </div>

  <div>
    <h4 class="mt-0 mb-4 text-900 font-bold">سجل النشاطات</h4>

    <p-timeline [value]="request.logs" styleClass="custom-timeline w-full">
      <ng-template pTemplate="content" let-log>
        <div class="flex flex-col gap-4 px-3" style="max-width: 300px">
          <span class="text-xs text-500 font-medium mb-1" dir="ltr">
            {{ log.createdAt | date : "dd MMM yyyy" }}
          </span>
          <p class="m-0 text-700 line-height-3 text-sm">
            {{ log.comment }}
          </p>
        </div>
      </ng-template>

      <ng-template pTemplate="marker" let-log>
        <span
          class="custom-marker shadow-1"
          [style.backgroundColor]="
            !log.isPublic ? 'darkgray' : getEventColor(log.newStatus)
          "
        >
          <i
            [class]="
              !log.isPublic ? 'pi pi-megaphone' : getEventIcon(log.newStatus)
            "
            class="text-white text-xs"
          ></i>
        </span>
      </ng-template>

      <ng-template pTemplate="opposite" let-log>
        <div class="px-3 pb-5">
          <div
            class="status-card shadow-1 p-2 border-round-md items-center gap-2 inline-flex surface-card"
            [style.border-right]="
              '4px solid ' +
              (!log.isPublic ? 'darkgray' : getEventColor(log.newStatus))
            "
          >
            <span class="font-bold text-900">{{ getEventLabel(log) }}</span>
          </div>
        </div>
      </ng-template>
    </p-timeline>

    <div *ngIf="!request.logs?.length" class="text-center p-4 text-500">
      <i class="pi pi-spin pi-spinner mb-2 text-xl" *ngIf="loading"></i>
      <span *ngIf="!loading">لا يوجد سجل نشاطات حتى الآن.</span>
    </div>
  </div>
</div>
